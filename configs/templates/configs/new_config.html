{% extends "mainpage/wrapper.html" %}


{% block content %}
  <p>{{auto}}</p>
  <div class="row-new-config-form">
    <div class="column-new-config-form new-column-one" onclick="openTab('b1');" style="background:grey;">
      <p class="config-subtitle">Добавить конфигурацию 1-ой стадии</p>
    </div>
    <div class="column-new-config-form new-column-two" onclick="openTab('b2');" style="background:rgb(0, 111, 214);">
      <p class="config-subtitle">Добавить конфигурацию 2-ой стадии</p>
    </div>
    <div class="column-new-config-form new-column-three" onclick="openTab('b3');" style="background:rgb(0, 20, 199);">
      <p class="config-subtitle">Добавить конфигурацию 3-ей стадии</p>
    </div>
    <div class="column-new-config-form new-column-four" onclick="openTab('b4');" style="background:black;">
      <p class="config-subtitle">Добавить конфигурацию 3+ стадии</p>
    </div>
  </div>

  <form action="" method="post">
    {% csrf_token %}
    <div id="b1" class="containerTab" style="display:none;background:grey">
      <span onclick="this.parentElement.style.display='none'" class="closebtn">×</span>
      <br>
      {% for field in form1 %}
        {{field.label_tag}}
        <div>{{field}}</div>
      {% endfor %}
      <br>
      <input type="hidden" value="form1" name="this">
      <button id="id_s1btn" type="submit" class="btn btn-success">Добавить</button>
    </div>
  </form>

  <form action="" method="post">
    {% csrf_token %}
    <div id="b2" class="containerTab" style="display:none;background:rgb(0, 111, 214)">
      <span onclick="this.parentElement.style.display='none'" class="closebtn">×</span>
      <br>
      {% for field in form2 %}
        {{field.label_tag}}
        <div>{{field}}</div>
      {% endfor %}
      <br>
      <input type="hidden" value="form2" name="this">
      <button id="id_s2btn" type="submit" class="btn btn-success">Добавить</button>
    </div>
  </form>

  <form action="" method="post">
    {% csrf_token %}
    <div id="b3" class="containerTab" style="display:none;background:rgb(0, 20, 199)">
      <span onclick="this.parentElement.style.display='none'" class="closebtn">×</span>
      <br>
      {% for field in form3 %}
        {{field.label_tag}}
        <div>{{field}}</div>
      {% endfor %}
      <br>
      <input type="hidden" value="form3" name="this">
      <button id="id_s3btn" type="submit" class="btn btn-success">Добавить</button>
    </div>
  </form>

  <form action="" method="post">
    {% csrf_token %}
    <div id="b4" class="containerTab" style="display:none;background:black">
      <span onclick="this.parentElement.style.display='none'" class="closebtn">×</span>
      <br>
      {% for field in form4 %}
        {{field.label_tag}}
        <div>{{field}}</div>
      {% endfor %}
      <br>
      <input type="hidden" value="form4" name="this">
      <button id="id_s4btn" type="submit" class="btn btn-success">Добавить</button>
    </div>
  </form>

  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
  <script>
    $("select").addClass("custom-select")
    $("input").addClass("form-control")
    $("textarea").addClass("form-control")
    $(".btn-success").removeClass("form-control")

    var s1config = $("#id_fk_stage1").val();
    var s2config = $("#id_fk_stage2").val();
    var s3config = $("#id_fk_stage3").val();
    if (s1config == "Default") {
      $("#id_s2btn").prop("disabled", true);
    }
    if (s2config == "Default") {
      $("#id_s3btn").prop("disabled", true);
    }
    if (s3config == "Default") {
      $("#id_s4btn").prop("disabled", true);
    }

    $("#id_fk_stage1").change(function () {
      var s1 = $("#id_fk_stage1").val();

      if (s1 == "Default") {
        $("#id_s2btn").prop("disabled", true);
      }
      else {
        $("#id_s2btn").prop("disabled", false);
      }
    })

    $("#id_fk_stage2").change(function () {
      var s2 = $("#id_fk_stage2").val();

      if (s2 == "Default") {
        $("#id_s3btn").prop("disabled", true);
      }
      else {
        $("#id_s3btn").prop("disabled", false);
      }
    })

    $("#id_fk_stage3").change(function () {
      var s3 = $("#id_fk_stage3").val();

      if (s3 == "Default") {
        $("#id_s4btn").prop("disabled", true);
      }
      else {
        $("#id_s4btn").prop("disabled", false);
      }
    })

    function openTab(tabName) {
      var i, x;
      x = document.getElementsByClassName("containerTab");
      for (i = 0; i < x.length; i++) {
         x[i].style.display = "none";
      }
      document.getElementById(tabName).style.display = "block";
    }
  </script>
{% endblock %}
